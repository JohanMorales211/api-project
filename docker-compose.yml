version: '3'
services:

  db-reservations:
    container_name: db-reservations
    image: postgres:15.2
    restart: unless-stopped
    environment:
      POSTGRES_DB: pg_reservations
      POSTGRES_USER: root
      POSTGRES_PASSWORD: 1234
    ports:
      - 8781:8781


  db-hosting:
    container_name: db-hosting
    image: postgres:15.2
    restart: unless-stopped
    environment:
      POSTGRES_DB: pg_hosting
      POSTGRES_USER: root
      POSTGRES_PASSWORD: 1234
    ports:
      - 8782:8782


  db-airline:
    container_name: db-airline
    image: postgres:15.2
    restart: unless-stopped
    environment:
      POSTGRES_DB: pg_airline
      POSTGRES_USER: root
      POSTGRES_PASSWORD: 1234
    ports:
      - 8783:8783

  db-user:
    container_name: db-user
    image: postgres:15.2
    restart: unless-stopped
    environment:
      POSTGRES_DB: pg_user
      POSTGRES_USER: root
      POSTGRES_PASSWORD: 1234
    ports:
      - 8784:8784

  eureka-service:
    container_name: eureka_service
    image: services:eureka_service-0.0.1-SNAPSHOT.jar
    build: ./eureka-service
    restart: always
    ports:
      - 8761:8761

  airline-service:
    container_name: airline_service
    image: services:airline_service-0.0.1-SNAPSHOT.jar
    build: ./airline-service
    restart: always
    environment:
      - DATABASE_URL=jdbc:postgresql://db-airline:5432/pg_airline
      - DATABASE_USERNAME=root
      - DATABASE_PASSWORD=1234
      - eureka.client.service-url.defaultZone=http://eureka-service:8761/eureka
    depends_on:
      - db-airline
      - eureka-service

  hosting-service:
    container_name: hosting_service
    image: services:hosting_service-0.0.1-SNAPSHOT.jar
    build: ./hosting-service
    restart: always
    environment:
      - DATABASE_URL=jdbc:postgresql://db-hosting:5432/pg_hosting
      - DATABASE_USERNAME=root
      - DATABASE_PASSWORD=1234
      - eureka.client.service-url.defaultZone=http://eureka-service:8761/eureka
    depends_on:
      - db-hosting
      - eureka-service

  reservation-service:
    container_name: reservation_service
    image: services:reservation_service-0.0.1-SNAPSHOT.jar
    build: ./reservation-service
    restart: always
    environment:
      - DATABASE_URL=jdbc:postgresql://db-reservations:5432/pg_reservations
      - DATABASE_USERNAME=root
      - DATABASE_PASSWORD=1234
      - eureka.client.service-url.defaultZone=http://eureka-service:8761/eureka
    depends_on:
      - db-reservations
      - eureka-service

  user-service:
    container_name: user_service
    image: services:user_service-0.0.1-SNAPSHOT.jar
    build: ./user-service
    restart: always
    environment:
      - DATABASE_URL=jdbc:postgresql://db-user:5432/pg_user
      - DATABASE_USERNAME=root
      - DATABASE_PASSWORD=1234
      - eureka.client.service-url.defaultZone=http://eureka-service:8761/eureka
    depends_on:
      - db-user
      - eureka-service

  gateway-service:
    image: services:gateway_service-0.0.1-SNAPSHOT.jar
    build: ./gateway-service
    restart: always
    ports:
      - "8780:8780"
    environment:
      eureka.client.service-url.defaultZone: http://eureka-service:8761/eureka
    depends_on:
      - airline-service
      - eureka-service
      - hosting-service
      - reservation-service
      - user-service